var AWS = require('./aws');

var s3 = exports.s3 = new AWS.S3({apiVersion: '2006-03-01'});

var getBucketRegion = exports.getBucketRegion = function getBucketRegion(bucket, callback) {
  s3.getBucketLocation({
    Bucket: bucket
  }, callback);
};

var getObjects = exports.getObjects = function getObjects(bucket, region, marker, callback) {
  if (typeof marker === 'function') {
    callback = marker;
    marker = undefined;
  }
  s3.listObjects({
    Bucket: bucket,
    Marker: marker || ''
  }, callback);
};

var getObjectDetails = exports.getObjectDetails = function getObjectDetails(bucket, key, callback) {
  s3.getObject({
    Bucket: bucket,
    Key: key,
  }, callback);
};
